<!-- ‚úÖ UNIQUE ORANGE ORBIT LOADER -->
<div class="page-loader" *ngIf="loading">
  <div class="orbit-loader">
    <span class="dot dot1"></span>
    <span class="dot dot2"></span>
    <span class="dot dot3"></span>
  </div>

  <p class="loader-text">Logging in...</p>
</div>


<!-- MAIN PAGE -->
<div class="login-page" [class.blur]="loading">

  <!-- LEFT PANEL -->
  <div class="login-left">
    <h1>Welcome to MyApp</h1>
    <p class="tagline">
      Modern authentication made simple
      <span>Crafted with Angular.</span>
    </p>
  </div>

  <!-- RIGHT PANEL -->
  <div class="login-right">
    <div class="login-card">

      <!-- LOGIN FORM -->
      <ng-container *ngIf="!isForgotPassword">

        <h2>Sign In</h2>
        <p class="subtitle">Access your dashboard</p>

        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">

          <!-- Mobile -->
          <div class="form-group">
            <label>Mobile Number</label>
            <div class="input-wrapper">
              <span class="material-icons input-icon">phone</span>
              <input type="text" formControlName="MobileNo" placeholder="Enter mobile number" />
            </div>
          </div>

          <!-- Password -->
          <div class="form-group">
            <label>Password</label>
            <div class="input-wrapper">
              <span class="material-icons input-icon">lock</span>
              <input [type]="showPassword ? 'text' : 'password'" formControlName="password"
                placeholder="Enter password" />
              <span class="material-icons eye-icon" (click)="togglePassword()">
                {{ showPassword ? 'visibility_off' : 'visibility' }}
              </span>
            </div>
          </div>

          <!-- Captcha -->
          <div class="form-group captcha-group">
            <label>Captcha</label>

            <div class="captcha-box">
              <span class="captcha-text">{{ captchaText }}</span>
              <button type="button" class="captcha-refresh" (click)="generateCaptcha()" title="Refresh Captcha">
                üîÑ
              </button>
            </div>

            <div class="input-wrapper">
              <input type="text" formControlName="captcha" placeholder="Enter captcha" />
            </div>

            <div class="captcha-error" *ngIf="captchaInvalid">
              Invalid captcha
            </div>
          </div>

          <!-- Forgot -->
          <div class="forgot">
            <a (click)="showForgotPassword()">Forgot password?</a>
          </div>

          <!-- Login Button -->
          <button type="submit" [disabled]="loading || loginForm.invalid">
            Login
          </button>

          <!-- OR Divider -->
          <div class="or-divider">
            <span>OR</span>
          </div>


          <!-- Aadhaar Login -->
          <button type="button" class="aadhaar-btn" (click)="openAadhaarModal()">
            Login with Aadhaar
          </button>

          <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>

        </form>
      </ng-container>

      <!-- FORGOT PASSWORD FORM -->
      <ng-container *ngIf="isForgotPassword">

        <h2>Forgot Password</h2>
        <p class="subtitle">We will send a reset link / OTP</p>

        <form [formGroup]="forgotForm" (ngSubmit)="onForgotSubmit()">

          <div class="form-group">
            <label>Mobile Number</label>
            <div class="input-wrapper">
              <span class="material-icons input-icon">phone</span>
              <input type="text" formControlName="MobileNo" placeholder="Enter registered mobile number" />
            </div>
          </div>

          <button type="submit">Send</button>

          <div class="forgot">
            <a (click)="backToLogin()">‚Üê Back to login</a>
          </div>

          <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>

        </form>
      </ng-container>

    </div>
  </div>
</div>

<!-- ================= AADHAAR LOGIN MODAL ================= -->
<div class="aadhaar-overlay" *ngIf="showAadhaarModal">
  <div class="aadhaar-modal">

    <!-- Header -->
    <div class="aadhaar-header">
      <div>
        <h3>Aadhaar Authentication</h3>
        <p>OTP will be sent to mobile linked with Aadhaar</p>
      </div>

      <button type="button" class="close-btn" (click)="closeAadhaarModal()">‚úï</button>
    </div>

    <!-- Aadhaar -->
    <div class="aadhaar-field">
      <label class="aadhaar-label">Aadhaar Number <span class="required">*</span></label>

      <div class="aadhaar-row">
        <input
          type="text"
          maxlength="12"
          name="aadhaarNumber"
          placeholder="Enter Aadhaar Number"
          [(ngModel)]="aadhaarNumber" />

        <button
          type="button"
          class="aadhaar-btn"
          (click)="sendAadhaarOtp()">
          Send OTP
        </button>
      </div>
    </div>

    <!-- Divider -->
    <div class="or-divider">
      <span>OTP</span>
    </div>

    <!-- OTP -->
    <div class="aadhaar-field">
      <label class="aadhaar-label">Enter OTP <span class="required">*</span></label>

      <div class="aadhaar-row">
        <input
          type="text"
          maxlength="6"
          name="aadhaarOtp"
          placeholder="Enter OTP"
          [(ngModel)]="aadhaarOtp"
          [disabled]="!otpSent" />

        <button
          type="button"
          class="aadhaar-btn verify"
          (click)="verifyAadhaarOtp()"
          [disabled]="!otpSent">
          Verify OTP
        </button>
      </div>
    </div>

  </div>
</div>
